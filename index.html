<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reservation Codes</title>
    <script>
        async function fetchData() {
            const response = await fetch('https://docs.google.com/spreadsheets/d/17nzVj38yKCpDRVUAYTqBpUnOShxu6oYquWXPbYhQEQ0/pub?gid=0&single=true&output=csv');
            const data = await response.text();
            const rows = data.split('\n').slice(1).map(row => row.split(','));

            const params = new URLSearchParams(window.location.search);
            const code = params.get('code');

            const reservation = rows.find(row => row[0] === code);

            if (reservation) {
                document.getElementById('checkInCode').innerText = `Check-in code: ${reservation[1]}`;
                document.getElementById('checkOutCode').innerText = `Check-out code: ${reservation[2]}`;
            } else {
                document.getElementById('content').innerText = 'Oops..something went wrong, please contact host via Airbnb message';
            }
        }

        window.onload = fetchData;
    </script>
</head>
<body>
    <div id="content">
        <h1>Reservation Details</h1>
        <p id="checkin-code"></p>
        <p id="checkout-code"></p>
    </div>
</body>
</html>